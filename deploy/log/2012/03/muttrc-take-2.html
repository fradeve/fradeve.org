<!doctype html>
<!-- https://github.com/paulirish/html5-boilerplate/blob/master/index.html -->
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="">

  <!-- encoding must be specified within the first 512 bytes
        www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#charset -->

  <!-- meta element for compatibility mode needs to be before
        all elements except title & meta
        msdn.microsoft.com/en-us/library/cc288325(VS.85).aspx -->
  <!-- Chrome Frame is only invoked if meta element for
        compatibility mode is within the first 1K bytes
        code.google.com/p/chromium/issues/detail?id=23003 -->

  <title>muttrc, take 2</title>
  <meta name="description" content="">
  <meta name="author" content="Francesco de Virgilio">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="">

    <!-- Place favicon.ico & apple-touch-icon.png
        in the root of your domain and delete these references -->
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    <link rel="stylesheet" href="/media/css/site.css">
  <link rel="stylesheet" href="/media/css/syntax.css">
  
    <!-- All JavaScript at the bottom, except for Modernizr which
        enables HTML5 elements & feature detects -->
   <script src="/media/js/libs/modernizr-1.7.min.js"></script>
    </head>
<body id="muttrc-take-2">
                  <div id="main" role="main">

          <header class="clearfix">
          </header>

          <section class="content">
          <article>

<h1 class="title">
    <a href="/log/2012/03/muttrc-take-2.html">
        muttrc, take 2
    </a>
</h1>

<time datetime="2012-03-18">
    Posted on 18 Mar 2012
</time>
<br>
<tags>tags:
	<a href="/tags/mail.html">mail</a>, 
	<a href="/tags/mutt.html">mutt</a> 
</tags>

<h6 class="description">
    <a href="/log/2012/03/muttrc-take-2.html">
        
    </a>
</h6>

<p><em>Ultimo aggiornamento: 09 agosto&nbsp;2012</em></p>
<p><span class="caps">NB</span>: una versione differente di questo stesso muttrc, con meno funzioni e flessibilità, è reperibile nel mio <a href="/log/2012/01/my-muttrc.html">post di gennaio</a>; ho voluto conservare il vecchio post senza aggiornarlo perché potrebbe tornare utile a chi cerca configurazioni più semplici e <em>monolitiche</em> (passatemi il&nbsp;termine).</p>
<p>La caratteristica principale di questo nuovo muttrc è la modularità: ogni account ha un suo file di configurazione, nel quale sono riportati i settaggi validi per il medesimo, rimuovendo ogni configurazione precedente nel momento del caricamento, che avviene grazie a semplici&nbsp;shortcut.</p>
<p>Rimangono valide le spiegazioni date nel post di gennaio. Tutti i file usati in questo tutorial sono hostati su <a href="https://github.com/fradeve/dotfiles">GitHub</a>, con l&#8217;esclusione di <a href="http://upsilon.cc/~zack/blog/posts/2011/01/how_to_use_Notmuch_with_Mutt/">mutt-notmuch</a>. Il codice è scaricabile dopo aver installato <span class="caps">GIT</span>, con il seguente&nbsp;comando:</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">fradeve</span><span class="o">/</span><span class="n">dotfiles</span><span class="p">.</span><span class="n">git</span>
</pre></div>


<p>I file utili a configurare mutt sono nella cartella <code>mutt-fradeve</code>.</p>
<h2 id="perche-un-muttrc-modulare">Perché un muttrc&nbsp;modulare</h2>
<p>Ciò che ho imparato dal precedente muttrc è che, se si vuol essere perfezionisti, è poco pratico e molto laborioso mantenere tutti i settaggi in un unico file. In fondo, ogni file occupa qualche kilobyte, non rovina la vita a&nbsp;nessuno.</p>
<h2 id="perche-sbattersi">Perché&nbsp;sbattersi</h2>
<p>Questo muttrc è fortemente orientato alla privacy. I settaggi danno per scontato&nbsp;che:</p>
<ul>
<li>si stia lavorando con una $<span class="caps">HOME</span>&nbsp;criptata</li>
<li>si voglia comunque avere un backup in tempo reale dei settaggi nella propria Dropbox, ma senza fare in modo che dal cloud si possa avere accesso a password, documenti, mail,&nbsp;etc.</li>
</ul>
<p>Inoltre, questo muttrc lavora (insieme ad altri programmi) per offrire la lettura di email sia tramite <span class="caps">IMAP</span> (quindi in near-real-time), sia tramite un archivio locale di tutta la posta di ogni account, sincronizzato ogni 5 minuti con <a href="http://offlineimap.org">offlineIMAP</a> all&#8217;interno della propria $<span class="caps">HOME</span> criptata. In questa maniera posso leggere la posta velocemente e direttamente da <span class="caps">IMAP</span> quando sono a casa, o dall&#8217;archivio aggiornato in locale quando sono in viaggio. Questo significa che per ogni account da configurare viene&nbsp;creato:</p>
<ul>
<li>un file di configurazione per la lettura via <span class="caps">IMAP</span> (<code>conf_on</code>)</li>
<li>un file di configurazione per la lettura via archivio locale (<code>conf_off</code>)</li>
</ul>
<p>Ovviamente, ci&nbsp;sarà:</p>
<ul>
<li>un file per la configurazione di mutt in modalità <span class="caps">IMAP</span> (<code>muttonrc</code>)</li>
<li>un file per la configurazione di mutt in modalità archivio locale (<code>muttrc</code>)</li>
</ul>
<p>Può tornare utile inserire in <code>.bashrc</code> degli alias per avviare mutt in una delle due&nbsp;modalità:</p>
<div class="codehilite"><pre><span class="n">alias</span> <span class="n">mutt</span><span class="p">=</span><span class="s">&#39;mutt -n -F /home/user/.mutt/muttrc&#39;</span>
<span class="n">alias</span> <span class="n">mutton</span><span class="p">=</span><span class="s">&#39;mutt -n -F /home/user/.mutt/muttonrc&#39;</span>
</pre></div>


<h2 id="install"><span class="caps">INSTALL</span></h2>
<p>Il file <span class="caps">INSTALL</span> riporta tutto ciò che serve per far funzionare il&nbsp;gioco.</p>
<p>La sezione 2 riporta i software da installare per far funzionare tutto. Alcuni di questi vengono esplicitamente richiamati nei due file rc di mutt, e sono riportare le linee in cui ciò avviene; altri offrono semplicemente funzioni utili, e nessun numero di riga è stato&nbsp;riportato.</p>
<p>In particolare, tra i passaggi preliminari (sezione 3),&nbsp;troviamo:</p>
<ul>
<li>file da copiare, spesso nella cartella di mutt nella propria&nbsp;home</li>
<li>file da decifrare e inserire nella propria home (contenenti le password ed i dati&nbsp;sensibili)</li>
<li>file che rimangono al loro posto in Dropbox e vengono caricati direttamente da&nbsp;lì</li>
<li>file che rimangono al loro posto in Dropbox e vengono <em>symlinkati</em> nella&nbsp;home</li>
</ul>
<p>La sezione 4 riporta la riga da inserire in crontab (<code>crontab -e</code>) per avviare la sincronizzazione di offlineIMAP ogni 5&nbsp;minuti.</p>
<h2 id="file-cifrati">File&nbsp;cifrati</h2>
<p>Il contenuto dei file cifrati è il&nbsp;seguente.</p>
<h3 id="muttpassgpg">muttpass.gpg</h3>
<div class="codehilite"><pre><span class="n">account1</span><span class="o">:</span>   <span class="n">pw</span>
<span class="n">account2</span><span class="o">:</span>   <span class="n">pw</span>  
<span class="n">account3</span><span class="o">:</span>   <span class="n">pw</span>
</pre></div>


<h3 id="offlineimaprcgpg">offlineimaprc.gpg</h3>
<div class="codehilite"><pre><span class="k">[general]</span>
<span class="na">metadata</span> <span class="o">=</span> <span class="s">~/.offlineimap</span>
<span class="na">accounts</span> <span class="o">=</span> <span class="s">account1,account2,account3</span>
<span class="na">maxsyncaccount</span> <span class="o">=</span> <span class="s">4</span>
<span class="na">socktimeout</span> <span class="o">=</span> <span class="s">60</span>
<span class="na">ui</span> <span class="o">=</span> <span class="s"><span class="caps">TTY</span>.<span class="caps">TTYUI</span></span>

<span class="c">### account1@host1.com </span>
<span class="c">#######################</span>

<span class="k">[Account account1]</span>
<span class="na">localrepository</span> <span class="o">=</span> <span class="s">local-account1</span>
<span class="na">remoterepository</span> <span class="o">=</span> <span class="s">remote-account1</span>

<span class="k">[Repository local-account1]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">Maildir</span>
<span class="na">localfolders</span> <span class="o">=</span> <span class="s">/home/user/.mail/account1</span>

<span class="k">[Repository remote-account1]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">Gmail</span>
<span class="na">remotehost</span> <span class="o">=</span> <span class="s">imap.host1.com</span>
<span class="na">remoteuser</span> <span class="o">=</span> <span class="s">account1@host1.com</span>
<span class="na">remotepass</span> <span class="o">=</span> <span class="s">pw</span>
<span class="na">ssl</span> <span class="o">=</span> <span class="s">yes</span>
<span class="na">realdelete</span> <span class="o">=</span> <span class="s">no</span>

<span class="c">### account2@host2.com</span>
<span class="c">######################################</span>

<span class="k">[Account account2]</span>
<span class="na">localrepository</span> <span class="o">=</span> <span class="s">local-account2</span>
<span class="na">remoterepository</span> <span class="o">=</span> <span class="s">remote-account2</span>

<span class="k">[Repository local-account2]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">Maildir</span>
<span class="na">localfolders</span> <span class="o">=</span> <span class="s">/home/user/.mail/account2</span>

<span class="k">[Repository remote-account2]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s"><span class="caps">IMAP</span></span>
<span class="na">ssl</span> <span class="o">=</span> <span class="s">yes</span>
<span class="c">#remoteport = 995</span>
<span class="na">remotehost</span> <span class="o">=</span> <span class="s">mail.host2.org</span>
<span class="na">remoteuser</span> <span class="o">=</span> <span class="s">account2@host2.org</span>
<span class="na">remotepass</span> <span class="o">=</span> <span class="s">pw</span>
<span class="na">realdelete</span> <span class="o">=</span> <span class="s">no</span>

<span class="c">### account3@host3.net</span>
<span class="c">######################################</span>

<span class="k">[Account account3]</span>
<span class="na">localrepository</span> <span class="o">=</span> <span class="s">local-account3</span>
<span class="na">remoterepository</span> <span class="o">=</span> <span class="s">remote-account3</span>

<span class="k">[Repository local-account3]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">Maildir</span>
<span class="na">localfolders</span> <span class="o">=</span> <span class="s">/home/user/.mail/account3</span>

<span class="k">[Repository remote-account3]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s"><span class="caps">IMAP</span></span>
<span class="na">ssl</span> <span class="o">=</span> <span class="s">yes</span>
<span class="c">#remoteport = 995</span>
<span class="na">remotehost</span> <span class="o">=</span> <span class="s">mail.host3.net</span>
<span class="na">remoteuser</span> <span class="o">=</span> <span class="s">account3@host3.net</span>
<span class="na">remotepass</span> <span class="o">=</span> <span class="s">pw</span>
<span class="na">realdelete</span> <span class="o">=</span> <span class="s">no</span>
</pre></div>


<h3 id="netrc">~/.netrc</h3>
<div class="codehilite"><pre><span class="n">machine</span> <span class="n">host1</span><span class="p">.</span><span class="n">com</span>
<span class="n">login</span> <span class="n">account1</span><span class="p">@</span><span class="n">host1</span><span class="p">.</span><span class="n">com</span>
<span class="n">password</span> <span class="n">pw</span>
</pre></div></article>
<div id="disqus_thread" ></div>
<style>
/* remove unnecessary disqus cruft from view */
.dsq-comment-header{background:none !important; border:none !important;}
.dsq-post-tools, .dsq-button, .dsq-textarea-background{ background:none !important;}
#dsq-like-thread-button .dsq-toolbar-label, #dsq-subscribe, #dsq-sort-select, .dsq-trackback-url, .dsq-brlink {display:none !important;}
</style>
<script type="text/javascript">
        var disqus_developer = 1; // developer mode is on
        var disqus_shortname = 'jseabold';
    var disqus_identifier = "log/2012/03/muttrc-take-2.html";
    var disqus_url = "http://jseabold.netlog/2012/03/muttrc-take-2.html";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
          <footer>
          <!-- this website is proudly powered by <a href="http://www.python.org/">Python</a>,
          build with the static site generator <a href="http://hyde.github.com/">Hyde</a>, 
          source code hosted on <a href="https://github.com/fspaolo/">GitHub</a>,
	  and written using <a href="http://www.vim.org/">VIM</a>. -->
          </footer>
          </section>

          <div id="sidebar">
                              <nav class=nav>
    <ul>
                <li>
            <a title="About me and this site"
                class="about"
                href="/about">
                About</a>
        </li>        <li>
            <a title="Wow, a blog!"
                class="log"
                href="/log">
                Log</a>
        </li>        <li>
            <a title="Posts in Italian"
                class="log"
                href="/log/index_it.html">
                it</a>
        </li>        <li>
            <a title="Posts in English"
                class="log"
                href="/log/index_en.html">
                en</a>
        </li>        <li>
            <a title="Blog's tags"
                class="log"
                href="/tags">
                Tags</a>
        </li>        <li>
            <a title="Blog's feed"
                class="log"
                href="/atom.xml">
                Feed</a>
        </li>    </ul>
</nav>
                              </div>

          </div>
        
    <!-- Javascript at the bottom for fast page loading -->
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
  
    
  <!--[if lt IE 7 ]>
    <script src="js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]-->

  <!--    -->

  </body>
</html>