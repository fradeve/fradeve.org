<!doctype html>
<!-- https://github.com/paulirish/html5-boilerplate/blob/master/index.html -->
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="">

  <!-- encoding must be specified within the first 512 bytes
        www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#charset -->

  <!-- meta element for compatibility mode needs to be before
        all elements except title & meta
        msdn.microsoft.com/en-us/library/cc288325(VS.85).aspx -->
  <!-- Chrome Frame is only invoked if meta element for
        compatibility mode is within the first 1K bytes
        code.google.com/p/chromium/issues/detail?id=23003 -->

  <title>Grid computing with Apple's Xgrid</title>
  <meta name="description" content="Setting up a grid of computers with the Apple's Xgrid software (Desktop version).">
  <meta name="author" content="Fernando Paolo">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="">

    <!-- Place favicon.ico & apple-touch-icon.png
        in the root of your domain and delete these references -->
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    <link rel="stylesheet" href="/media/css/site.css">
  <link rel="stylesheet" href="/media/css/syntax.css">
  
    <!-- All JavaScript at the bottom, except for Modernizr which
        enables HTML5 elements & feature detects -->
   <script src="/media/js/libs/modernizr-1.7.min.js"></script>
    </head>
<body id="2011-util-grid-computing">
                  <div id="main" role="main">

          <header class="clearfix">
          </header>

          <section class="content">
          <article>

<h1 class="title">
    <a href="/log/2011-util-grid-computing.html">
        Grid computing with Apple's Xgrid
    </a>
</h1>

<time datetime="2011-12-26">
    Posted on 26 Dec 2011
</time>

<h6 class="description">
    <a href="/log/2011-util-grid-computing.html">
        Setting up a grid of computers with the Apple's Xgrid software (Desktop version).
    </a>
</h6>

<h2 id="the-xgrid-agent">The Xgrid&nbsp;agent</h2>
<p>Configure the agent using the Sharing panel in System&nbsp;Preferences.</p>
<h2 id="the-xgrid-controller">The Xgrid&nbsp;controller</h2>
<p>Straightforward on Mac <span class="caps">OS</span> X <strong>Server</strong>. On the Desktop version use the <strong>XgridLite</strong> open source software&nbsp;to:</p>
<ul>
<li>Turn on and off the built-in Xgrid controller with a single&nbsp;click</li>
<li>Set passwords for client and agent&nbsp;authentication</li>
<li>Reset the controller to default&nbsp;settings</li>
</ul>
<h2 id="the-xgrid-daemon-control-interface">The Xgrid Daemon Control&nbsp;Interface</h2>
<p>Command&nbsp;line: </p>
<div class="codehilite"><pre><span class="nv">$ </span>xgridctl
</pre></div>


<p>Start the&nbsp;controller:</p>
<div class="codehilite"><pre><span class="nv">$ </span>ssh username@remote.controller.edu
<span class="nv">$ </span>sudo xgridctl c start
</pre></div>


<p>Turn off an&nbsp;agent:</p>
<div class="codehilite"><pre><span class="nv">$ </span>ssh username@remote.agent.edu
<span class="nv">$ </span>sudo xgridctl a stop
</pre></div>


<p>More&nbsp;options:</p>
<div class="codehilite"><pre><span class="nv">$ </span>sudo xgridctl
usage: xgridctl <span class="o">[</span>controller|agent<span class="o">]</span> status|start|stop|restart
</pre></div>


<h2 id="the-xgrid-admin-tool">The Xgrid Admin&nbsp;tool</h2>
<p>Provides a summary of the activity of the grid. Download a piece of Mac <span class="caps">OS</span> X Server for free from <a href="http://support.apple.com/downloads/">Apple&#8217;s website</a>.</p>
<h2 id="a-hack-for-snow-leopard">A hack for Snow&nbsp;Leopard&#8230;</h2>
<p>To have read/write permission on the agents in <code>/Volumes</code> we need kerberos. But it is only available on Mac <span class="caps">OS</span> X <strong>Server</strong>&#8230; instead, one can simply change the configuration&nbsp;files:</p>
<div class="codehilite"><pre><span class="nv">$ </span>sudo cp /usr/share/sandbox/xgridagentd_task_nobody.sb  <span class="se">\</span>
          /usr/share/sandbox/xgridagentd_task_nobody.sb.bak

<span class="nv">$ </span>sudo cp /usr/share/sandbox/xgridagentd_task_somebody.sb  <span class="se">\ </span>
          /usr/share/sandbox/xgridagentd_task_nobody.sb
</pre></div>


<h2 id="the-xgrid-command-line-client">The xgrid command-line&nbsp;client</h2>
<p>Set the environmental&nbsp;variables:</p>
<div class="codehilite"><pre><span class="nv">$ </span><span class="nb">export </span><span class="nv">XGRID_CONTROLLER_HOSTNAME</span><span class="o">=</span>hostname
<span class="nv">$ </span><span class="nb">export </span><span class="nv">XGRID_CONTROLLER_PASSWORD</span><span class="o">=</span>password
</pre></div>


<p>Client submits jobs to the&nbsp;controller:</p>
<div class="codehilite"><pre><span class="nv">$ </span>xgrid -job submit /usr/bin/python -O test1.txt

<span class="o">{</span><span class="nv">jobIdentifier</span> <span class="o">=</span> 231; <span class="o">}</span>
</pre></div>


<p>Client queries the&nbsp;results:</p>
<div class="codehilite"><pre><span class="nv">$ </span>xgrid -job results -id 231
</pre></div>


<h2 id="agent-jobs">Agent&nbsp;jobs</h2>
<p>What is copied to the&nbsp;agents?</p>
<ul>
<li>The <strong>Command</strong> (if relative path): <code>/tmp/xgagent.GSI0Z6o4/bin/sh</code></li>
<li>The <strong>Working dir</strong> (if relative path): <code>/tmp/xgagent.bUDiNL4g</code></li>
</ul>
<h2 id="client-results">Client&nbsp;results</h2>
<p>What is copied back to the&nbsp;client?</p>
<ul>
<li>The <strong>stdout</strong>&nbsp;stream</li>
<li>The <strong>stderr</strong>&nbsp;stream</li>
<li>The <strong>working&nbsp;dir</strong></li>
</ul>
<h2 id="submitting-multiple-jobs">Submitting multiple&nbsp;jobs</h2>
<p>Single task jobs. Simply let the controller managing the&nbsp;jobs:</p>
<div class="codehilite"><pre><span class="nv">$ </span>xgrid -job submit /usr/bin/python test1.py
<span class="nv">$ </span>xgrid -job submit /usr/bin/python test2.py
<span class="nv">$ </span>xgrid -job submit /usr/bin/python test3.py
...
</pre></div>


<h2 id="running-batch-jobs">Running batch&nbsp;jobs</h2>
<p>Multiple task jobs. Use the following scripts to create and send batch files to the controller, and to retrive the&nbsp;results:</p>
<ul>
<li><a href="https://github.com/fspaolo/code/tree/master/xgrid">xg-batch.py</a></li>
<li><a href="https://github.com/fspaolo/code/tree/master/xgrid">xg-result.py</a></li>
</ul>
<p>To generate and submit a batch file with jobs that call a program <code>prog</code> with command line argument <code>arg</code> on several&nbsp;files:</p>
<div class="codehilite"><pre><span class="nv">$ </span>python xg-batch.py -s -j jobname -c <span class="s2">&quot;/path/to/prog -a arg&quot;</span> /path/to/files/*.ext
</pre></div>


<p>Retrieving results by passing <span class="caps">ID</span> files (generated by <code>xg-batch.py</code>):</p>
<div class="codehilite"><pre><span class="nv">$ </span>python xg-result.py file1.id file2.id file3.id ...
</pre></div>


<p>Or by passing a dir containing those&nbsp;files:</p>
<div class="codehilite"><pre><span class="nv">$ </span>python xg-result.py /path/to/dir
</pre></div>


<h2 id="more-info">More&nbsp;info</h2>
<ul>
<li>Xgrid: <a href="http://www.apple.com/science/hardware/gridcomputing.html">http://www.apple.com/science/hardware/gridcomputing.html</a></li>
<li>Tutorials: <a href="http://macresearch.org/the_xgrid_tutorials">http://macresearch.org/the_xgrid_tutorials</a></li>
</ul>
</article>          <footer>
          this website is proudly powered by <a href="http://www.python.org/">Python</a>,
          build with the static site generator <a href="http://hyde.github.com/">Hyde</a>, 
          pages and source code hosted on <a href="https://github.com/fspaolo/">GitHub</a>,
          and all the text written using <a href="http://www.vim.org/">VIM</a>.
          </footer>
          </section>

          <div id="sidebar">
                              <nav class=nav>
    <ul>
        <!-- added extra item (fspaolo 2011-11-16) -->
        <li>
            <a title="Source code" href="https://github.com/fspaolo/code">
            Code
            </a>
        </li>
        <!-- end added extra item -->
                <li>
            <a title="Research projects"
                class="research"
                href="/research">
                Research</a>
        </li>        <li>
            <a title="Miscellaneous material"
                class="active log"
                href="/log">
                Log</a>
        </li>        <li>
            <a title="About me and this site"
                class="about"
                href="/about">
                About</a>
        </li>    </ul>
</nav>
                              </div>

          </div>
        
    <!-- Javascript at the bottom for fast page loading -->
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
  
    
  <!--[if lt IE 7 ]>
    <script src="js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]-->

      
  </body>
</html>